import{n as k,r as o,g as L,B as R,j as e,_ as C,l as P,J as U,S as E}from"./index-BSZQSoAt.js";import{u as $,c as q}from"./projectsApi-BgJbOpgZ.js";function V(){const I=k(),S=o.useRef(null),[t,h]=o.useState([]),[r,j]=o.useState([]),[u,f]=o.useState(""),[g,b]=o.useState(""),{id:v}=L(),{data:m}=$(v),a=m==null?void 0:m.data,{data:x}=R(),p=x==null?void 0:x.data,[D,{isLoading:N}]=q();o.useEffect(()=>{var s,n;a&&(f(a.description),h([{data_url:`https://www.api.ruperbangla.com${a.image}`}]),b((s=a==null?void 0:a.category)==null?void 0:s._id),j((n=a==null?void 0:a.gallery)==null?void 0:n.map(d=>({data_url:`https://www.api.ruperbangla.com${d}`}))))},[a]);const G=async s=>{var w,y,_;s.preventDefault();const n=s.target.title.value,d=s.target.location.value,i=new FormData;i.append("title",n),i.append("category",g),i.append("location",d),u.length>0&&i.append("description",u),(t==null?void 0:t.length)>0&&t[0].file&&i.append("mainImage",t[0].file),r==null||r.map(c=>{c!=null&&c.file&&i.append("galleryImages",c==null?void 0:c.file)});const l=await D({id:v,formData:i});(w=l==null?void 0:l.data)!=null&&w.success?(E.fire("","Project updated successfully","success"),I("/admin/project/all")):(E.fire("",((_=(y=l==null?void 0:l.error)==null?void 0:y.data)==null?void 0:_.message)||"Something went wrong!","error"),console.log(l))};return e.jsxs("section",{className:"rounded bg-base-100 shadow",children:[e.jsx("div",{className:"flex items-center justify-between border-b p-4 font-medium text-neutral",children:e.jsx("h3",{children:"Edit Project"})}),e.jsxs("form",{className:"p-4",onSubmit:G,children:[e.jsxs("div",{className:"flex flex-col gap-4 text-neutral-content",children:[e.jsxs("div",{className:"grid items-center gap-3 sm:grid-cols-2 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1",children:"Title"}),e.jsx("input",{type:"text",name:"title",required:!0,defaultValue:a==null?void 0:a.title})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-1",children:"Category"}),e.jsx("select",{onChange:s=>b(s.target.value),required:!0,value:g,children:p==null?void 0:p.map(s=>e.jsx("option",{defaultValue:s,value:s._id,children:s.name},s._id))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-1",children:"Location"}),e.jsx("input",{type:"text",name:"location",required:!0,defaultValue:a==null?void 0:a.location})]})]}),e.jsx("div",{className:"grid gap-3 rounded border border-dashed p-4 sm:grid-cols-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"mb-1",children:"Main Image"}),e.jsx(C,{value:t,onChange:s=>h(s),dataURLKey:"data_url",maxNumber:1,children:({onImageUpload:s,onImageRemove:n,dragProps:d})=>e.jsxs("div",{...d,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{onClick:s,className:"w-max cursor-pointer rounded-2xl bg-primary px-4 py-1.5 text-sm text-base-100",children:"Choose Image"}),e.jsx("p",{className:"text-neutral-content",children:"or Drop here"})]}),(t==null?void 0:t.length)>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("img",{src:t[0].data_url,alt:"Main",className:"w-24"}),e.jsx("div",{onClick:()=>n(0),className:"absolute right-0 top-0 flex h-7 w-7 cursor-pointer items-center justify-center rounded-full bg-primary text-base-100",children:e.jsx(P,{})})]})]})})]})}),e.jsx("div",{className:"grid gap-3 rounded border border-dashed p-4 sm:grid-cols-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"mb-1",children:"Gallery Images"}),e.jsx(C,{value:r,onChange:s=>j(s),dataURLKey:"data_url",multiple:!0,maxNumber:10,children:({onImageUpload:s,onImageRemove:n,dragProps:d})=>e.jsxs("div",{...d,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{onClick:s,className:"w-max cursor-pointer rounded-2xl bg-primary px-4 py-1.5 text-sm text-base-100",children:"Choose Images"}),e.jsx("p",{className:"text-neutral-content",children:"or Drop here"})]}),(r==null?void 0:r.length)>0&&e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:r==null?void 0:r.map((i,l)=>e.jsxs("div",{className:"image-item relative",children:[e.jsx("img",{src:i.data_url,alt:"Gallery",className:"w-full"}),e.jsx("div",{onClick:()=>n(l),className:"absolute right-0 top-0 flex h-7 w-7 cursor-pointer items-center justify-center rounded-full bg-primary text-base-100",children:e.jsx(P,{})})]},l))})]})})]})}),e.jsxs("div",{className:"rounded border md:col-span-2",children:[e.jsx("p",{className:"border-b p-3",children:"Project Description"}),e.jsx("div",{className:"about_details p-4",children:e.jsx(U,{ref:S,value:u,onBlur:s=>f(s)})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{className:"admin_btn",disabled:N,children:N?"Updating...":"Edit Project"})})]})]})}export{V as default};
