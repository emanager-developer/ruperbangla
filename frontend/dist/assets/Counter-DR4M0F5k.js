import{j as e,af as F,ag as I,r as h,ah as L,ai as _,aj as k,f as A,_ as D,l as E,S as x}from"./index-BSZQSoAt.js";function M({counts:n,setCounts:r}){const t=()=>{r([...n,{title:"",number:""}])},o=(s,l)=>{const a=[...n];l.target.name==="title"?a[s].title=l.target.value:a[s].number=l.target.value,r(a)},g=s=>{const l=[...n];l.splice(s,1),r(l)},m=()=>n.every(s=>s.title!==""&&s.number!=="");return e.jsxs("div",{className:"mt-3 flex flex-col gap-3 rounded border p-3",children:[n==null?void 0:n.map((s,l)=>e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsx("input",{type:"text",name:"title",placeholder:"title",value:s.title,onChange:a=>o(l,a)}),e.jsx("input",{type:"number",name:"number",placeholder:"100",value:s.number,onChange:a=>o(l,a)}),e.jsx("button",{type:"button",onClick:()=>g(l),className:"flex w-20 items-center justify-center rounded-md bg-red-500 text-white",children:e.jsx(F,{})})]},l)),e.jsxs("button",{type:"button",onClick:t,disabled:(n==null?void 0:n.length)>0&&!m(),className:"flex w-max items-center gap-2 rounded bg-gray-500 px-4 py-2 text-sm text-base-100",children:[e.jsx(I,{className:"text-xs"})," Add Counting"]})]})}function T(){const[n,r]=h.useState(""),[t,o]=h.useState([]),[g,m]=h.useState([]),{data:s,isLoading:l}=L(),a=s==null?void 0:s.data,f=a==null?void 0:a._id;h.useEffect(()=>{a!=null&&a.counts&&(m(a==null?void 0:a.counts),r(a==null?void 0:a.title))},[a]);const[w,{isLoading:b}]=_(),[C,{isLoading:N}]=k(),S=async d=>{var p,u,v,y;d.preventDefault();const j=(p=t[0])==null?void 0:p.file,c=new FormData;if(c.append("title",n),c.append("image",j),c.append("counts",JSON.stringify(g)),f){const i=await C({id:f,formData:c});(u=i==null?void 0:i.data)!=null&&u.success?(x.fire("","Contact updated successfully","success"),r(""),o([]),m([])):(x.fire("","Something went wrong!","error"),console.log(i))}else{const i=await w(c);if((t==null?void 0:t.length)<=0)return x.fire("","Background image is required","warning");(v=i==null?void 0:i.data)!=null&&v.success?(x.fire("","Contact added successfully","success"),r(""),o([]),m([])):(x.fire("",((y=i==null?void 0:i.data)==null?void 0:y.message)||"Something went wrong!","error"),console.log(i))}};return l?e.jsx(A,{}):e.jsxs("section",{className:"rounded bg-base-100 pb-4 shadow",children:[e.jsx("div",{className:"border-b p-4 font-medium text-neutral",children:e.jsx("h3",{children:"Counter Setting"})}),e.jsxs("form",{onSubmit:S,className:"form_group mx-4 mt-3 flex flex-col gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1",children:"Title"}),e.jsx("input",{type:"text",required:!0,defaultValue:a==null?void 0:a.title,onChange:d=>r(d.target.value)})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"mb-1",children:"Background Image"}),e.jsx(D,{defaultValue:t,onChange:d=>o(d),dataURLKey:"data_url",children:({onImageUpload:d,onImageRemove:j,dragProps:c})=>e.jsxs("div",{className:"items-center gap-10 rounded border border-dashed p-4 md:flex",...c,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{onClick:d,className:"w-max cursor-pointer rounded-2xl bg-primary px-4 py-1.5 text-sm text-base-100",children:"Choose Image"}),e.jsx("p",{className:"text-neutral-content",children:"or Drop here"})]}),e.jsx("div",{className:`${(t==null?void 0:t.length)>0&&"mt-4"} `,children:t==null?void 0:t.map((p,u)=>e.jsxs("div",{className:"image-item relative",children:[e.jsx("img",{src:p.data_url,alt:"counter",className:"h-20 w-32",loading:"lazy"}),e.jsx("div",{onClick:()=>j(u),className:"absolute right-0 top-0 flex h-7 w-7 cursor-pointer items-center justify-center rounded-full bg-primary text-base-100",children:e.jsx(E,{})})]},u))})]})}),(a==null?void 0:a.bgImage)&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:`https://www.api.ruperbangla.com/${a==null?void 0:a.bgImage}`,alt:"counter",className:"h-20 w-40",loading:"lazy"})})]})]}),e.jsx(M,{counts:g,setCounts:m}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{disabled:b||N,className:"admin_btn",children:b||N?"Loading...":f?"Update":"Add"})})]})]})}export{T as default};
